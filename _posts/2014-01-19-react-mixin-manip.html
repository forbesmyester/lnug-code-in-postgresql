---
layout: post
title: React Mixin Manip
tag: 
---

<p>I have created a simple <a href="https://gist.github.com/forbesmyester/8469940">React Mixin</a> which enables you to use the power of <a href="https://github.com/forbesmyester/manip">Manip</a> with the awsomeness of <a href="http://facebook.github.io/">React</a>.</p><p>When you want to alter data within React you can use the <code>component.setState()</code> or <code>component.setProps()</code> methods. This is wonderful if you want to modify top level data... But that is not always the case, consider how the following data may be rendered with React:</p><pre><code>{<br />    jack: { hair: &#39;brown&#39;, eyes: &#39;blue&#39;, age: 4 },<br />    jane: { hair: &#39;blonde&#39;, eyes: &#39;brown&#39;, age: 2 },<br />    jill: { hair: &#39;red&#39;, eyes: &#39;blue&#39;, age: 7 }<br />}</code></pre><p>This would probably be outputted using the following code:</p><pre><code>React.renderComponent(<br />    &lt;Output data={data}/&gt;,<br />    document.getElementById(&#39;...&#39;)<br />);</code></pre><p>Now suppose that somehow you know Jill's age is now 8, or maybe only that her age has increased by one. It may be, depending on where you are in the code that you still have access to all the data, but it is also quite possible you do not.</p><p>In this situation it is impossible for you to use <code>component.setProps()</code> because it will also overwrite all information about everyone else! Infact given the documented external API's of a React component it is impossible for you to perform the required manipulation without significant bespoke work. The aim of React_Mixin_Manip is to make this job much more simple....</p><p>See the example below:</p><pre><code>// Create a React class to show nested data and which uses the<br />// React_Mixin_Manip mixin.<br />var Output = React.createClass({<br />    <br />    mixins: [React_Mixin_Manip],<br />    <br />    render: function() {<br />        <br />        var nodes = [];<br />        for (var k in this.props.peopleData) {<br />            if (this.props.peopleData.hasOwnProperty(k)) {<br />                nodes.push(&lt;dt&gt;{k}&lt;/dt&gt;);<br />                nodes.push(&lt;dd&gt;{JSON.stringify(this.props.peopleData[k])}&lt;/dd&gt;);<br />            }<br />        }<br />        <br />        return (<br />            &lt;div&gt;<br />                &lt;dl&gt;{nodes}&lt;/dl&gt;<br />            &lt;/div&gt;<br />        );<br />    }<br />});<br /><br />var getData = function() {<br />    return {<br />        jack: { hair: &#39;brown&#39;, eyes: &#39;blue&#39;, age: 4 },<br />        jane: { hair: &#39;blonde&#39;, eyes: &#39;brown&#39;, age: 2 },<br />        jill: { hair: &#39;red&#39;, eyes: &#39;blue&#39;, age: 7 }<br />    };<br />};<br /><br />// Render the above component into the HTML<br />var output = React.renderComponent(<br />        &lt;Output peopleData={getData()} /&gt;,<br />        document.getElementById(&#39;example&#39;)<br />    );<br /><br />// After 1.5 seconds fiddle with the data within the component using<br />// manip... Note that this is impossible to write using the React <br />// `setProps()` method.<br />setTimeout(function() {<br />    output.manip(<br />        false,<br />        {&#39;$inc&#39;: {&#39;peopleData.jill.age&#39;: 1}},<br />        function() {<br />            console.log(&quot;Manipulation Done!&quot;);<br />        }<br />    );<br />}, 1500);</code></pre><p>After 1.5 seconds the age of Jill will be increased by one. In this situation it is impossible to access the original data from within the <code>setTimeout()</code> call. Using React_Mixin_Manip has provided a reasonably clean way to perform the required manipulation with very little work.</p><p>Note: The reason this has been released as a Gist instead of a full GitHub repository is that I am not sure on a sensible way to test it... It will become a repository when I either figure out the testing or when I need it as a repository to use with <a href="https://npmjs.org">NPM</a> or <a href="http://bower.io/">Bower</a>.</p><style>pre {     margin: 1em;     background-color: #DDD;     padding: 0.5em;     border: 1px #AAA solid; }  pre code {     padding: 0 0; }  code {     background-color: #DDD;     padding: 0 0.3em; } </style> 
