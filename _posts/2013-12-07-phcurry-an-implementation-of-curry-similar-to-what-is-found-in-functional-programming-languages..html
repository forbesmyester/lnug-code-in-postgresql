---
layout: post
title: PHCurry - An implementation of Curry similar to what is found in functional
  programming languages.
tag: 
---

<style>     pre {         margin: 1em;         background-color: #DDD;         padding: 0.5em;         border: 1px #AAA solid;     }          pre code {       padding: 0 0;     }          code {       background-color: #DDD;       padding: 0 0.3em;     }  </style><p>Currying is a concept from functional programming where you allow you a function that would normally need <code>n</code> arguments to be called with fewer arguments. When you do this it will return a function with you current arguments stored, but waiting for the extra arguments. When all arguments are finally stored/passed the function will be invoked.</p><p>An Example:</p><pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span><br /><span class="kw">require_once</span> <span class="st">&#39;phcurry.php&#39;</span><span class="ot">;</span><br /><br /><span class="kw">$volumeCalculator</span> = <span class="kw">function</span><span class="ot">(</span><span class="kw">$w</span><span class="ot">,</span> <span class="kw">$h</span><span class="ot">,</span> <span class="kw">$l</span><span class="ot">)</span> {<br />    <span class="kw">return</span> <span class="kw">$w</span> * <span class="kw">$h</span> * <span class="kw">$l</span><span class="ot">;</span><br />}<span class="ot">;</span><br /><span class="kw">$iKnowTheWidth</span> = phcurry<span class="ot">(</span><span class="kw">$volumeCalculator</span><span class="ot">,</span> <span class="dv">3</span><span class="ot">);</span><br /><span class="kw">$iKnowTheWidthAndHeight</span> = <span class="kw">$iKnowTheWidth</span><span class="ot">(</span><span class="dv">2</span><span class="ot">);</span><br /><span class="fu">echo</span> <span class="st">&quot;The volume is &quot;</span> . <span class="kw">$iKnowTheWidthAndHeight</span><span class="ot">(</span><span class="dv">4</span><span class="ot">);</span><br /><span class="kw">?&gt;</span></code></pre><h1 id="thats-great-but-what-is-the-use...">That's great, but what is the use...</h1><p>Why not think about a mapping function...</p><pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span><br /><span class="kw">require_once</span> <span class="st">&#39;phcurry.php&#39;</span><span class="ot">;</span><br /><br /><span class="kw">$map</span> = <span class="kw">function</span><span class="ot">(</span><span class="kw">$func</span><span class="ot">,</span> <span class="kw">$collection</span><span class="ot">)</span> { <span class="co">// Only required because</span><br />    <span class="kw">return</span> <span class="fu">array_map</span><span class="ot">(</span><span class="kw">$func</span><span class="ot">,</span> <span class="kw">$collection</span><span class="ot">);</span><br />}<span class="ot">;</span><br /><br /><span class="kw">$getId</span> = <span class="kw">function</span><span class="ot">(</span><span class="kw">$obj</span><span class="ot">)</span> { <span class="kw">return</span> <span class="kw">$obj</span><span class="ot">[</span><span class="st">&#39;id&#39;</span><span class="ot">];</span> }<span class="ot">;</span><br /><br /><span class="kw">$getIds</span> = phcurry<span class="ot">(</span><span class="kw">$map</span><span class="ot">,</span> <span class="kw">$getId</span><span class="ot">);</span>       <br /><br /><span class="kw">$data</span> = <span class="fu">array</span><span class="ot">(</span><br />    <span class="fu">array</span><span class="ot">(</span><span class="st">&#39;id&#39;</span>=&gt;<span class="st">&#39;f3ds&#39;</span><span class="ot">,</span> <span class="st">&#39;name&#39;</span>=&gt; <span class="st">&#39;Jack&#39;</span><span class="ot">),</span><br />    <span class="fu">array</span><span class="ot">(</span><span class="st">&#39;id&#39;</span>=&gt;<span class="st">&#39;adb9&#39;</span><span class="ot">,</span> <span class="st">&#39;name&#39;</span>=&gt; <span class="st">&#39;Jill&#39;</span><span class="ot">),</span><br />    <span class="fu">array</span><span class="ot">(</span><span class="st">&#39;id&#39;</span>=&gt;<span class="st">&#39;93cd&#39;</span><span class="ot">,</span> <span class="st">&#39;name&#39;</span>=&gt; <span class="st">&#39;John&#39;</span><span class="ot">),</span><br />    <span class="fu">array</span><span class="ot">(</span><span class="st">&#39;id&#39;</span>=&gt;<span class="st">&#39;e236&#39;</span><span class="ot">,</span> <span class="st">&#39;name&#39;</span>=&gt; <span class="st">&#39;Jude&#39;</span><span class="ot">)</span><br /><span class="ot">);</span><br /><br /><span class="fu">echo</span> <span class="st">&quot;The user Ids are: &quot;</span> . <span class="fu">implode</span><span class="ot">(</span><span class="st">&#39;, &#39;</span><span class="ot">,</span> <span class="kw">$getIds</span><span class="ot">(</span><span class="kw">$data</span><span class="ot">));</span><br /><span class="kw">?&gt;</span></code></pre><p>Yes but you could have achieved this with:</p><pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span> <br /><span class="fu">echo</span> <span class="st">&quot;The user Ids are: &quot;</span> . <span class="fu">implode</span><span class="ot">(</span><br />    <span class="st">&#39;, &#39;</span><span class="ot">,</span><br />    <span class="fu">array_map</span><span class="ot">(</span><span class="kw">function</span><span class="ot">(</span><span class="kw">$obj</span><span class="ot">)</span> { <span class="kw">return</span> <span class="kw">$obj</span><span class="ot">[</span><span class="st">&#39;id&#39;</span><span class="ot">];</span> }<span class="ot">,</span> <span class="kw">$data</span><span class="ot">)</span><br /><span class="ot">);</span><br /><span class="kw">?&gt;</span></code></pre><p>That is true, I would argue that the previous was better because it is broken up into smaller parts which could be more testable and because each little function is named after it's actually doing. PHCurry is still not proving to be <strong>that</strong> useful though, but combining it with <a href="https://github.com/forbesmyester/PHChain">PHChain</a> so you can chain these tiny functions together you can take it a little further...</p><pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span><br /><span class="kw">require_once</span> <span class="st">&#39;phcurry.php&#39;</span><span class="ot">;</span><br /><span class="kw">require_once</span> <span class="st">&#39;../phchain/phchain.php&#39;</span><span class="ot">;</span><br /><br /><span class="co">// Gets the relative path of a file relative to a parent directory</span><br /><span class="co">// TODO: Make this not throw exceptions when it is not within the parent</span><br /><span class="kw">$getRelativePath</span> = <span class="kw">function</span><span class="ot">(</span><span class="kw">$parentPath</span><span class="ot">,</span> <span class="kw">$absoluteChildPath</span><span class="ot">)</span> {<br />    <span class="kw">if</span> <span class="ot">(</span><span class="fu">substr</span><span class="ot">(</span><span class="kw">$absoluteChildPath</span><span class="ot">,</span> <span class="dv">0</span><span class="ot">,</span> <span class="fu">strlen</span><span class="ot">(</span><span class="kw">$parentPath</span><span class="ot">))</span> != <span class="kw">$parentPath</span><span class="ot">)</span> {<br />        <span class="kw">throw</span> <span class="kw">new</span> <span class="kw">Exception</span><span class="ot">(</span><span class="kw">$absoluteChildPath</span> . <span class="st">&#39; is not stored beneath &#39;</span> . <span class="kw">$parentPath</span><span class="ot">);</span><br />    }<br />    <span class="kw">return</span> <span class="fu">preg_replace</span><span class="ot">(</span><br />        <span class="st">&#39;/^\//&#39;</span><span class="ot">,</span><br />        <span class="st">&#39;&#39;</span><span class="ot">,</span><br />        <span class="fu">substr</span><span class="ot">(</span><span class="kw">$absoluteChildPath</span><span class="ot">,</span> <span class="fu">strlen</span><span class="ot">(</span><span class="kw">$parentPath</span><span class="ot">))</span><br />    <span class="ot">);</span><br />}<span class="ot">;</span><br /><br /><span class="kw">$extractField</span> = <span class="kw">function</span><span class="ot">(</span><span class="kw">$field</span><span class="ot">,</span> <span class="kw">$record</span><span class="ot">)</span> {<br />    <span class="kw">return</span> <span class="kw">$record</span><span class="ot">[</span><span class="kw">$field</span><span class="ot">];</span><br />}<span class="ot">;</span><br /><br /><span class="kw">$extractRelativePath</span> = phchain<span class="ot">(</span><span class="fu">array</span><span class="ot">(</span><br />    phcurry<span class="ot">(</span><span class="kw">$extractField</span><span class="ot">,</span> <span class="st">&#39;location&#39;</span><span class="ot">),</span><br />    phcurry<span class="ot">(</span><br />        <span class="kw">$getRelativePath</span><span class="ot">,</span><br />        <span class="st">&#39;/home/fozz&#39;</span><br />    <span class="ot">)</span><br /><span class="ot">));</span><br /><br /><span class="kw">$relativePaths</span> = <span class="fu">array_map</span><span class="ot">(</span><br />    <span class="kw">$extractRelativePath</span><span class="ot">,</span><br />    <span class="fu">array</span><span class="ot">(</span><br />        <span class="fu">array</span><span class="ot">(</span><br />            <span class="st">&#39;location&#39;</span>=&gt;<span class="st">&#39;/home/fozz/Documents/CV.html&#39;</span><span class="ot">,</span><br />            <span class="st">&#39;description&#39;</span>=&gt;<span class="st">&#39;All about me!&#39;</span><br />        <span class="ot">),</span><br />        <span class="fu">array</span><span class="ot">(</span><br />            <span class="st">&#39;location&#39;</span>=&gt;<span class="st">&quot;/home/fozz/Music/MC Hammer - Can&#39;t Touch This.mp3&quot;</span><span class="ot">,</span><br />            <span class="st">&#39;description&#39;</span>=&gt;<span class="st">&quot;Super famous early 90&#39;s song&quot;</span><br />        <span class="ot">),</span><br />        <span class="fu">array</span><span class="ot">(</span><br />            <span class="st">&#39;location&#39;</span>=&gt;<span class="st">&#39;/home/fozz/Music/Blur - Parklife.mp3&#39;</span><span class="ot">,</span><br />            <span class="st">&#39;description&#39;</span>=&gt;<span class="st">&quot;Super famous mid 90&#39;s song&quot;</span><br />        <span class="ot">),</span><br />        <span class="fu">array</span><span class="ot">(</span><br />            <span class="st">&#39;location&#39;</span>=&gt;<span class="st">&#39;/home/fozz/Projects/phcurry/README.md&#39;</span><span class="ot">,</span><br />            <span class="st">&#39;description&#39;</span>=&gt;<span class="st">&quot;phcurry&#39;s README in Markdown format&quot;</span><br />        <span class="ot">)</span><br />    <span class="ot">)</span><br /><span class="ot">);</span><br /><br /><span class="fu">echo</span> <span class="st">&quot;Inside your my directory I have I have the following files:</span><span class="kw">\n</span><span class="st">&quot;</span><span class="ot">;</span><br /><span class="fu">echo</span> <span class="fu">implode</span><span class="ot">(</span><span class="st">&quot;</span><span class="kw">\t\n</span><span class="st">&quot;</span><span class="ot">,</span> <span class="kw">$relativePaths</span><span class="ot">);</span><br /><span class="kw">?&gt;</span></code></pre>
